!function(t){function e(t){if(!(t=t.trim()))return document.createElement("div");const e=t.match(/^([a-zA-Z][\w-]*)?/);let n=e&&e[1]?e[1]:"div",r=t.slice(n.length),s=document.createElement(n);const o=r.match(/#([\w-]+)/);o&&(s.id=o[1],r=r.replace(o[0],""));const a=[];let i;const l=/\.([\w-]+)/g;for(;i=l.exec(r);)a.push(i[1]);let h;a.length&&(s.className=a.join(" ")),r=r.replace(l,"");const c=/\[([\w-]+)(=(["']?)(.*?)\3)?\]/g;for(;h=c.exec(r);){let t=h[1],e=void 0!==h[4]?h[4]:"";s.setAttribute(t,e)}return s}let n={};function r(t,e){let n=[],r=0,s=0;for(;r<t.length&&s<e.length;)if(t[r]===e[s])r++,s++;else{let o=r,a=s;for(;o<t.length&&t[o]!==e[s];)o++;for(;a<e.length&&e[a]!==t[r];)a++;o-r<a-s?(r<o&&n.push({start:r,end:o,replace:e.slice(s,s)}),r=o):(s<a&&n.push({start:r,end:r,replace:e.slice(s,a)}),s=a)}return r<t.length&&n.push({start:r,end:t.length,replace:""}),s<e.length&&n.push({start:t.length,end:t.length,replace:e.slice(s)}),n}function s(t,e){let n=0;for(const{start:r,end:s,replace:o}of e)t=t.slice(0,r+n)+o+t.slice(s+n),n+=o.length-(s-r);return t}function o(t,e=""){const n=[];for(const r in t)"function"==typeof t[r]?n.push({path:e+r,handler:t[r]}):"object"==typeof t[r]&&null!==t[r]&&n.push(...o(t[r],e+r));return n}function a(t){this.elements=t,this._flaroTimestamp=Date.now()+Math.floor(1e6*Math.random())}function i(t,e={}){const n=this,r="history"===e.mode?"history":"hash",s=e.root||"/",a=!1!==e.listen,l=o(t),h=l.map(({path:t,handler:e})=>({path:t,regex:i.pathToRegex(t),handler:e}));let c=null;l.forEach(({path:t,handler:e})=>{("*"===t||/^\*[\d]+$/.test(t))&&(c=e)});let u=null;function f(t){const e=function(){let t,e="",n="",o="";if("history"===r)o=window.location.pathname+window.location.search+window.location.hash,t=window.location.pathname.replace(s,"/")||"/",e=window.location.search,n=window.location.hash;else{let r=window.location.hash.slice(1),s=r.indexOf("?"),o=r.indexOf("#");-1===s&&-1===o?t=r||"/":-1!==s&&(-1===o||s<o)?(t=r.slice(0,s),e=r.slice(s,-1===o?void 0:o),n=-1===o?"":r.slice(o)):-1!==o&&(t=r.slice(0,o),n=r.slice(o))}return{pathname:t,search:e,hash:n}}();if(!t&&e.pathname===u)return;u=e.pathname;let o=!1;for(let t of h){const r=e.pathname.match(t.regex);if(r){const s=i.extractParams(t.path,r);t.handler({pathname:e.pathname,search:e.search,hash:e.hash,status:200,routeParams:s},n.elements),o=!0;break}}if(!o&&c){let t=404,r=l.find(t=>/^\*\d+$/.test(t.path));r&&(t=parseInt(r.path.slice(1),10)||404),c({pathname:e.pathname,search:e.search,hash:e.hash,status:t,routeParams:{}},n.elements)}}return i.handleRoute=f,a?("history"===r?window.onpopstate=function(){f()}:window.onhashchange=function(){f()},setTimeout(()=>f(!0),0)):f(!0),this}function l(t){return new a(function(t){if("string"==typeof t)if(t.startsWith("@New")){const n=t.match(/@New\((.*?)\)In\((.*?)\)/);if(n){const[t,r,s]=n,o=e(r),a=document.querySelector(s);return a&&a.appendChild(o),[o]}{const n=t.match(/@New\((.*?)\)/);if(n){const t=e(n[1]);return document.body.appendChild(t),[t]}}}else if(t.startsWith("@Delete")){const e=t.match(/@Delete\((.*?)\)/);return e&&document.querySelector(e[1])?.remove(),[]}return"string"==typeof t?[...document.querySelectorAll(t)]:t instanceof Element?[t]:Array.isArray(t)?t:[]}(t))}a.prototype={el(){return this.elements},timestamp(){return this._flaroTimestamp},html(t){return void 0===t?this.elements[0]?.innerHTML:(this.elements.forEach(e=>e.innerHTML=t),this)},text(t){return void 0===t?this.elements[0]?.textContent:(this.elements.forEach(e=>e.textContent=t),this)},val(t){return void 0===t?this.elements[0]?.value:(this.elements.forEach(e=>e.value=t),this)},css(t){return this.elements.forEach(e=>{for(let n in t)e.style[n]=t[n]}),this},on(t,e){return this.elements.forEach(n=>{n._flaroEvents=n._flaroEvents||{},n.addEventListener(t,e),n._flaroEvents[t]||(n._flaroEvents[t]=[]),n._flaroEvents[t].push(e)}),this},off(t){return this.elements.forEach(e=>{e._flaroEvents&&e._flaroEvents[t]&&(e._flaroEvents[t].forEach(n=>e.removeEventListener(t,n)),e._flaroEvents[t]=[])}),this},toggleClass(...t){return this.elements.forEach(e=>e.classList.toggle(...t)),this},toggleAttr(...t){return this.elements.forEach(e=>{t.forEach(t=>{e.hasAttribute(t)?e.removeAttribute(t):e.setAttribute(t,"")})}),this},addClass(...t){return this.elements.forEach(e=>e.classList.add(...t)),this},removeClass(...t){return this.elements.forEach(e=>e.classList.remove(...t)),this},addAttr(t,e){return this.elements.forEach(n=>n.setAttribute(t,e)),this},removeAttr(...t){return this.elements.forEach(e=>{t.forEach(t=>e.removeAttribute(t))}),this},Class(t){if(void 0===t)return this.elements.length>0?new Set(this.elements[0].classList):new Set;if("string"==typeof t)return this.elements.length>0&&this.elements[0].classList.contains(t);if(Array.isArray(t))return this.addClass(...t);if("object"==typeof t&&null!==t){for(const e in t)t[e]?this.addClass(e):this.removeClass(e);return this}return this},Attr(t,e){if(void 0===e){if(0===this.elements.length)return null;const e=this.elements[0];if("string"==typeof t)return e.hasAttribute(t)?e.getAttribute(t):e.hasAttribute(t);if(Array.isArray(t)){const n={};return t.forEach(t=>{n[t]=e.getAttribute(t)}),n}}else{if("string"==typeof t)return this.addAttr(t,e);if("object"==typeof t&&null!==t)for(const e in t)this.addAttr(e,t[e])}return this},changeID(t){return this.elements.forEach(e=>e.id=t),this},comp(t){return this.elements.forEach(e=>{const n=l(e);let o,a,i="";if("function"==typeof t)a=t;else{if("string"!=typeof t)return"";a=l.comps[t]}function h(){const t=(n=i,(a=o)&&"object"==typeof a?n.replace(/(?<!\\)\{\{(\w+)\}\}/g,(t,e)=>a.hasOwnProperty(e)?a[e]:t).replace(/\\\{\{/g,"{{"):n.replace(/\\\{\{/g,"{{"));var n,a;if(e.innerHTML!==t){const n=r(e.innerHTML,t);e.innerHTML=s(e.innerHTML,n)}}o=n.reactiveData({},h),i=a(n,o,function t(){i=a(n,o,t),h()}),h()}),this},reactiveData(t,e,n=["dp-set"]){const r=n.includes("dp-set"),s=new WeakSet;function o(t){if(!r||"object"!=typeof t||null===t)return t;if(s.has(t))return t;const e=new Proxy(t,a);return s.add(e),e}const a={set(t,n,s){const a=t[n],i=r?o(s):s;return t[n]=i,a!==i&&"function"==typeof e&&e(n,i,t,a),!0},deleteProperty(t,n){const r=Object.prototype.hasOwnProperty.call(t,n),s=t[n],o=delete t[n];return o&&r&&"function"==typeof e&&e(n,void 0,t,s),o}};return r?o(t):new Proxy(t,a)},reRender(t){const e=document.querySelector(t);e&&l(e).html(e.innerHTML)},find(t){const e=[];return this.elements.forEach(n=>e.push(...n.querySelectorAll(t))),new a(e)},getClosest(t){return new a(this.elements.map(e=>e.closest(t)).filter(Boolean))},relative(t,e){const n=[];return this.elements.forEach(e=>{"parent"===t?n.push(e.parentElement):"children"===t?n.push(...e.children):"sibling"===t&&n.push(...e.parentElement?.children||[])}),e?new a(n).find(e):new a(n)},each(t){return this.elements.forEach((e,n)=>t.call(e,n,e)),this},id(){return this.elements[0]?.id||null},classes(){return[...this.elements[0]?.classList||[]]},attributes(){const t=this.elements[0];return t?[...t.attributes].map(t=>[t.name,t.value]):[]},$:function(...t){return l(...t)},refresh(){return window.location.reload(),this},reboot(){return window.location=window.location,this},reload(...t){return t.forEach(t=>{document.querySelectorAll(t).forEach(t=>t.outerHTML=t.outerHTML)}),this}},i.pathToRegex=function(t){return"*"===t?/^.*$/:new RegExp("^"+t.replace(/([:*])(\w+)/g,(t,e,n)=>":"===e?"([^/]+)":n).replace(/\//g,"\\/")+"$")},i.extractParams=function(t,e){const n=[],r=/:([\w]+)/g;let s;for(;null!==(s=r.exec(t));)n.push(s[1]);const o=e.slice(1),a={};return n.forEach((t,e)=>a[t]=o[e]),a},i.handleRoute=function(){},i.flattenRoutes=o,i.go=function(t,e={}){if("string"==typeof t&&t.startsWith("*"))return void("function"==typeof i.handleRoute&&i.handleRoute(!0));const n="history"===e.mode?"history":"hash",r=e.root||"/";"history"===n?(window.history.pushState(null,"",r.replace(/\/$/,"")+(t.startsWith("/")?t:"/"+t)),"function"==typeof i.handleRoute&&i.handleRoute(!0)):window.location.hash=t.startsWith("/")?t:"/"+t},a.prototype.router=i,l.store=function(t,e,r){switch(t){case"set":return"string"==typeof e&&"*"!==e&&(n[e]=r,!0);case"get":return"*"===e?{...n}:n[e];case"move":return!(!n.hasOwnProperty(e)||"string"!=typeof r||"*"===r)&&(n[r]=n[e],delete n[e],!0);case"type":case"typeof":return n.hasOwnProperty(e)?typeof n[e]:void 0;case"exists":return n.hasOwnProperty(e);case"proxy":return"string"==typeof e&&"*"!==e&&"object"==typeof r?(n.hasOwnProperty(e)||(n[e]={}),new Proxy(n[e],{})):new Proxy(n,e);default:throw new Error(`Unknown store action: ${t}`)}},l.fetch=function(t,e={},n){const r=e["fetch-config"]||{},s=e.type||"auto",o=e.awaitOutput||!1,a=fetch(t,r).then(async t=>{let e,n=t.headers.get("content-type")||"";e="json"===s||"auto"===s&&n.includes("application/json")?await t.json():"text"===s||"auto"===s&&n.includes("text/")?await t.text():"blob"===s||"auto"===s?await t.blob():await t.text();const r={ok:t.ok,status:t.status,statusText:t.statusText,headers:t.headers,body:e,response:t};return o?r:e});return n&&"object"==typeof n&&("function"==typeof n.then&&a.then(n.then),"function"==typeof n.catch&&a.catch(n.catch),"function"==typeof n.finally&&a.finally(n.finally)),a},l.router=i,l.reactiveData=l().reactiveData,l.stringDiff=r,l.patchDiff=s,l.refresh=()=>window.location.reload(),l.reboot=()=>document.documentElement.innerHTML=document.documentElement.innerHTML,l.reload=(...t)=>l().reload(...t),l.comps={},t.Flaro=l}(window);
